{"version":3,"file":"i18n-s.js","sources":["../lib/util.js","../index.js"],"sourcesContent":["export function regExpEscape(s){\n  return String(s).replace(/[\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n};\n","import {regExpEscape} from './lib/util';\n\nexport default class I18n {\n\n  constructor(locale, i18nData) {\n    this._locale = locale || 'zh';\n    this._i18nData = i18nData || {};\n  }\n\n  // set locale data of one locale\n  setLocaleData(locale, data={}) {\n    this._i18nData[locale] = data;\n  }\n\n  // set the current locale\n  setLocale(locale) {\n    this._locale = locale;\n  }\n\n  // translate keys\n  translate(key, vars={}) {\n    let locale = this._locale;\n    let data = this._i18nData[locale] || {};\n    let val = data[key];\n    let arr = key.split('.', 2);\n\n    if (!val && arr.length > 1) {\n      val = this.findDotTranslate(arr[1], data[arr[0]]);\n    }\n\n    if (!val) {\n      if (process.env.NODE_ENV !== 'production') {\n        console.log(`Translate lost: [${locale}] => [${key}]`);\n      }\n      return val;\n    }\n\n    return this.formatString(val, vars);\n  }\n\n  __(...args) {\n    return this.translate(...args);\n  }\n\n  findDotTranslate(key, data) {\n    if (typeof data !== 'object') return null;\n\n    let val = data[key];\n    let arr = key.split('.', 2);\n\n    if (val) return val;\n\n    if (arr.length > 1) {\n      val = this.findDotTranslate(arr[1], data[arr[0]]);\n    }\n\n    return val;\n  }\n\n  // format string\n  formatString(string, vars={}) {\n    Object.keys(vars).forEach((key) => {\n      let re = new RegExp('\\\\$\\\\{' + regExpEscape(key) + '\\\\}', 'g');\n      string = string.replace(re, vars[key]);\n    });\n    return string;\n  }\n}\n"],"names":["regExpEscape","s","String","replace","I18n","locale","i18nData","_locale","_i18nData","data","key","vars","val","arr","split","length","findDotTranslate","process","env","NODE_ENV","log","formatString","translate","string","keys","forEach","re","RegExp"],"mappings":";;;;;;AAAO,SAASA,YAAT,CAAsBC,CAAtB,EAAwB;SACtBC,OAAOD,CAAP,EAAUE,OAAV,CAAkB,qBAAlB,EAAyC,MAAzC,CAAP;;;;;;;;;ACDF,IAEqBC;gBAEPC,MAAZ,EAAoBC,QAApB,EAA8B;;;SACvBC,OAAL,GAAeF,UAAU,IAAzB;SACKG,SAAL,GAAiBF,YAAY,EAA7B;;;;;;;;kCAIYD,QAAiB;UAATI,IAAS,uEAAJ,EAAI;;WACxBD,SAAL,CAAeH,MAAf,IAAyBI,IAAzB;;;;;;;8BAIQJ,QAAQ;WACXE,OAAL,GAAeF,MAAf;;;;;;;8BAIQK,KAAc;UAATC,IAAS,uEAAJ,EAAI;;UAClBN,SAAS,KAAKE,OAAlB;UACIE,OAAO,KAAKD,SAAL,CAAeH,MAAf,KAA0B,EAArC;UACIO,MAAMH,KAAKC,GAAL,CAAV;UACIG,MAAMH,IAAII,KAAJ,CAAU,GAAV,EAAe,CAAf,CAAV;;UAEI,CAACF,GAAD,IAAQC,IAAIE,MAAJ,GAAa,CAAzB,EAA4B;cACpB,KAAKC,gBAAL,CAAsBH,IAAI,CAAJ,CAAtB,EAA8BJ,KAAKI,IAAI,CAAJ,CAAL,CAA9B,CAAN;;;UAGE,CAACD,GAAL,EAAU;YACJK,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;kBACjCC,GAAR,uBAAgCf,MAAhC,cAA+CK,GAA/C;;eAEKE,GAAP;;;aAGK,KAAKS,YAAL,CAAkBT,GAAlB,EAAuBD,IAAvB,CAAP;;;;yBAGU;aACH,KAAKW,SAAL,uBAAP;;;;qCAGeZ,KAAKD,MAAM;UACtB,QAAOA,IAAP,yCAAOA,IAAP,OAAgB,QAApB,EAA8B,OAAO,IAAP;;UAE1BG,MAAMH,KAAKC,GAAL,CAAV;UACIG,MAAMH,IAAII,KAAJ,CAAU,GAAV,EAAe,CAAf,CAAV;;UAEIF,GAAJ,EAAS,OAAOA,GAAP;;UAELC,IAAIE,MAAJ,GAAa,CAAjB,EAAoB;cACZ,KAAKC,gBAAL,CAAsBH,IAAI,CAAJ,CAAtB,EAA8BJ,KAAKI,IAAI,CAAJ,CAAL,CAA9B,CAAN;;;aAGKD,GAAP;;;;;;;iCAIWW,QAAiB;UAATZ,IAAS,uEAAJ,EAAI;;aACrBa,IAAP,CAAYb,IAAZ,EAAkBc,OAAlB,CAA0B,UAACf,GAAD,EAAS;YAC7BgB,KAAK,IAAIC,MAAJ,CAAW,WAAW3B,aAAaU,GAAb,CAAX,GAA+B,KAA1C,EAAiD,GAAjD,CAAT;iBACSa,OAAOpB,OAAP,CAAeuB,EAAf,EAAmBf,KAAKD,GAAL,CAAnB,CAAT;OAFF;aAIOa,MAAP;;;;;;;;;;;;;"}